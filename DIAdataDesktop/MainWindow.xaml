<Window x:Class="DIAdataDesktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewmodels="clr-namespace:DIAdataDesktop.ViewModels"
        xmlns:controls="clr-namespace:DIAdataDesktop.Views.Controls"
        xmlns:conv="clr-namespace:DIAdataDesktop.Converters"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="DIAdata Desktop" Height="780" Width="1180"
        WindowStartupLocation="CenterScreen"
        Background="#0B1220">

    <Window.DataContext>
        <viewmodels:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <!-- Converters -->
        <conv:InverseBooleanConverter x:Key="InvBool"/>
        <conv:BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <conv:StringToVisibilityConverter x:Key="StringToVis"/>
        <conv:StringEqualsToBoolConverter x:Key="StringEqualsToBool"/>
    </Window.Resources>

    <Grid Background="{StaticResource ContentBg}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <ColumnDefinition Width="12"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT SIDEBAR -->
        <Border Grid.Column="0"
                Background="{StaticResource SidebarBg}"
                BorderBrush="{StaticResource SidebarStroke}"
                BorderThickness="0,0,1,0">

            <DockPanel LastChildFill="True" Margin="16">

                <!-- Brand -->
                <StackPanel DockPanel.Dock="Top" Margin="0,6,0,14">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="48"/>
                            <ColumnDefinition Width="10"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Width="48" Height="48" CornerRadius="14"
                                Background="#0F234A" BorderBrush="#26406F" BorderThickness="1">
                            <TextBlock Text="D" Foreground="#B6D4FF"
                                       FontSize="24" FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"/>
                        </Border>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="DIA App" Foreground="{StaticResource SidebarText}"
                                       FontSize="18" FontWeight="SemiBold"/>
                            <TextBlock Text="DIAdata Desktop" Foreground="{StaticResource SidebarTextMuted}"
                                       FontSize="12" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>

                <!-- Menu -->
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>

                        <TextBlock Style="{StaticResource SidebarSectionHeader}" Text="Data library"/>

                        <!-- Data library (like DIA website) -->
                        <ToggleButton Style="{StaticResource SidebarMenuItem}"
                                      Tag="DataLibrary"
                                      Click="Nav_Click"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=DataLibrary}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="◈" Opacity="0.85" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Data library" FontWeight="SemiBold"/>
                            </Grid>
                        </ToggleButton>

                        <!-- Sub items (simple) -->
                        <ToggleButton Style="{StaticResource SidebarMenuItem}" Margin="14,6,0,0"
                                      Tag="DigitalAssets"
                                      Click="Nav_Click"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=DigitalAssets}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="›" Opacity="0.7" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Digital assets" Foreground="{StaticResource SidebarTextMuted}"/>
                            </Grid>
                        </ToggleButton>

                        <ToggleButton Style="{StaticResource SidebarMenuItem}" Margin="14,6,0,0"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=RealWorldAssets}"
                                      Command="{Binding NavigateCommand}" CommandParameter="RealWorldAssets">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="›" Opacity="0.7" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Real-world assets" Foreground="{StaticResource SidebarTextMuted}"/>
                            </Grid>
                        </ToggleButton>

                        <ToggleButton Style="{StaticResource SidebarMenuItem}" Margin="14,6,0,0"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=Randomness}"
                                      Command="{Binding NavigateCommand}" CommandParameter="Randomness">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="›" Opacity="0.7" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Randomness" Foreground="{StaticResource SidebarTextMuted}"/>
                            </Grid>
                        </ToggleButton>

                        <TextBlock Style="{StaticResource SidebarSectionHeader}" Text="Oracle"/>

                        <ToggleButton Style="{StaticResource SidebarMenuItem}"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=OraclePlayground}"
                                      Command="{Binding NavigateCommand}" CommandParameter="OraclePlayground">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="⬡" Opacity="0.9" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Oracle playground" FontWeight="SemiBold"/>
                                <Border Grid.Column="2" Margin="8,0,0,0" Padding="8,2"
                                        CornerRadius="999" Background="#1B3D2A" BorderBrush="#2C6E49" BorderThickness="1">
                                    <TextBlock Text="NEW" FontSize="11" Foreground="#BBF7D0"/>
                                </Border>
                            </Grid>
                        </ToggleButton>

                        <ToggleButton Style="{StaticResource SidebarMenuItem}"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=DataSources}"
                                      Command="{Binding NavigateCommand}" CommandParameter="DataSources">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="◌" Opacity="0.9" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Data sources" FontWeight="SemiBold"/>
                            </Grid>
                        </ToggleButton>

                        <ToggleButton Style="{StaticResource SidebarMenuItem}"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=SupportedChains}"
                                      Command="{Binding NavigateCommand}" CommandParameter="SupportedChains">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="⛓" Opacity="0.9" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Supported chains" FontWeight="SemiBold"/>
                            </Grid>
                        </ToggleButton>

                        <TextBlock Style="{StaticResource SidebarSectionHeader}" Text="Tools"/>

                        <ToggleButton Style="{StaticResource SidebarMenuItem}"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=Staking}"
                                      Command="{Binding NavigateCommand}" CommandParameter="Staking">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="▽" Opacity="0.9" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Staking" FontWeight="SemiBold"/>
                            </Grid>
                        </ToggleButton>

                        <ToggleButton Style="{StaticResource SidebarMenuItem}"
                                      IsChecked="{Binding SelectedNav, Mode=TwoWay, Converter={StaticResource StringEqualsToBool}, ConverterParameter=Bridge}"
                                      Command="{Binding NavigateCommand}" CommandParameter="Bridge">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="26"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="⇄" Opacity="0.9" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="Bridge" FontWeight="SemiBold"/>
                            </Grid>
                        </ToggleButton>
                        <Border DockPanel.Dock="Bottom" Margin="0,14,0,0"
             Background="#0C1A33"
             BorderBrush="{StaticResource SidebarStroke}"
             BorderThickness="1"
             CornerRadius="14"
             Padding="12">
                            <StackPanel>
                                <TextBlock Text="{Binding StatusChipText}" Foreground="{StaticResource SidebarText}" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding LastUpdateChipText}" Foreground="{StaticResource SidebarTextMuted}" Margin="0,3,0,0"/>
                                <Border Margin="0,10,0,0"
                     Background="#2B0F12" BorderBrush="#6B1F26" BorderThickness="1"
                     CornerRadius="12" Padding="10"
                     Visibility="{Binding Error, Converter={StaticResource StringToVis}}">
                                    <TextBlock Text="{Binding Error}" Foreground="#FCA5A5" TextWrapping="Wrap"/>
                                </Border>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
                
            </DockPanel>
        </Border>

        <!-- splitter between sidebar and content -->
        <GridSplitter Grid.Column="1"
                      Width="12"
                      Background="#0B1220"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      ShowsPreview="False"/>

        <!-- RIGHT CONTENT -->
        <Grid Grid.Column="2" Margin="18">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="14"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Top bar (optional, DIA-like) -->
            <Border Grid.Row="0"
                    Background="{StaticResource ContentCardBg}"
                    BorderBrush="{StaticResource ContentStroke}"
                    BorderThickness="1"
                    CornerRadius="16"
                    Padding="12">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="340"/>
                        <ColumnDefinition Width="12"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel>
                        <TextBlock Text="Explore data" Foreground="#E5E7EB" FontSize="18" FontWeight="SemiBold"/>
                        <TextBlock Text="Quotation, quoted assets, meta lists" Foreground="#9CA3AF" Margin="0,2,0,0"/>
                    </StackPanel>

                    <!-- Quick search could later bind to a global search -->
                    <TextBox Grid.Column="1"
                             Margin="0"
                             VerticalAlignment="Center"
                             Background="#0B1220"
                             Foreground="#E5E7EB"
                             BorderBrush="#24314E"
                             BorderThickness="1"
                             Padding="10,8"
                             Text="{Binding QuotedAssets.SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             ToolTip="Search quoted assets"/>
                    <Button Grid.Column="3"
                            Margin="0"
                            Padding="14,8"
                            Command="{Binding RefreshAllCommand}"
                            Style="{StaticResource GhostButton}"
                            IsEnabled="{Binding IsBusy, Converter={StaticResource InvBool}}"
                            Background="#1D4ED8"
                            Foreground="White"
                            BorderBrush="#2D64E3"
                            BorderThickness="1">
                        <TextBlock Text="Refresh"/>
                    </Button>
                </Grid>
            </Border>

            <ContentControl x:Name="MainContent" Grid.Row="2"/>
        </Grid>
    </Grid>
</Window>
